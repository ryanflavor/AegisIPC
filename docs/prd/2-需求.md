# **2\. 需求**

## **功能性需求 (Functional Requirements)**

* **FR1: 服务注册与发现**: 任何服务实例都必须能向中央路由组件注册其服务名称、实例ID，以及它正在处理的特定资源（例如，账户ID），并能被系统发现。
* **FR2: 服务组路由**: 对于可以有多个实例的服务组，请求可以被发送到该服务组的“服务名”，并由其中任意一个健康的实例接收并处理。
* **FR3: 目标路由**: 系统必须支持将请求精确地路由到管理特定资源的**唯一服务实例**。
* **FR4: 自动故障转移**: 中央路由组件必须能够通过心跳或健康检查机制实时监控服务实例的存活状态，并在主实例故障后自动将路由切换到其备用实例上。

## **非功能性需求 (Non-Functional Requirements)**

* **NFR1: 精确一次投递保证**: 在任何路由模式下，消息投递都必须保证“精确一次”语义，不能出现消息丢失或重复处理。
* **NFR2: 状态一致性保证**: 在主备切换过程中，必须有机制确保状态的最终一致性。
* **NFR3: 客户端连接透明性**: 客户端库（SDK）应能封装主备切换的复杂性，使该过程对业务调用方无感知。
* **NFR4: 可观测性**: 系统必须提供结构化的JSON日志输出，并暴露核心性能指标以便对接监控系统。
* **NFR5: 可管理性**: 系统必须提供一个基础的管理接口（如CLI），允许操作者查询和管理系统状态。

## **核心工程实践原则 (Core Engineering Principles)**

* 本项目开发将严格遵循用户提供的10项核心原则与工程实践，包括领域驱动设计、契约驱动开发、自动化代码质量保障、分层测试策略、容器化等。这些原则将作为所有故事开发的基本验收标准。
